<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–∞–ø-–¢–∞–ø –•–æ–º—è–∫</title>
    <script src="https://telegram.org/js/games.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        #game-container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        #game-area {
            width: 100%;
            height: 300px;
            background: #f0f8ff;
            border-radius: 10px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }
        #hamster {
            width: 80px;
            height: 80px;
            position: absolute;
            cursor: pointer;
            transition: transform 0.1s;
        }
        #hamster:active {
            transform: scale(0.9);
        }
        #score-display {
            font-size: 24px;
            margin: 10px 0;
        }
        #timer {
            font-size: 20px;
            color: #e74c3c;
            margin: 10px 0;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            transition: background 0.3s;
        }
        button:hover {
            background: #2980b9;
        }
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
        }
        .stat-box {
            background: #ecf0f1;
            padding: 10px;
            border-radius: 8px;
            min-width: 100px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>üêπ –¢–∞–ø-–¢–∞–ø –•–æ–º—è–∫</h1>
        <div class="stats">
            <div class="stat-box">
                <div>–°—á–µ—Ç</div>
                <div id="score-display">0</div>
            </div>
            <div class="stat-box">
                <div>–í—Ä–µ–º—è</div>
                <div id="timer">30</div>
            </div>
        </div>
        
        <div id="game-area">
            <img id="hamster" src="https://i.imgur.com/JR9Z1pO.png" alt="–•–æ–º—è–∫">
        </div>
        
        <button id="start-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
        <button id="finish-btn" disabled>–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
    </div>

    <script>
        // –ü–æ–ª—É—á–∞–µ–º user_id –∏–∑ URL
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get('user_id');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–≥—Ä—ã
        const hamster = document.getElementById('hamster');
        const gameArea = document.getElementById('game-area');
        const scoreDisplay = document.getElementById('score-display');
        const timerDisplay = document.getElementById('timer');
        const startBtn = document.getElementById('start-btn');
        const finishBtn = document.getElementById('finish-btn');
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥—Ä—ã
        let score = 0;
        let timeLeft = 30;
        let gameInterval;
        let timerInterval;
        let isGameRunning = false;
        
        // –†–∞–∑–º–µ—â–∞–µ–º —Ö–æ–º—è–∫–∞ —Å–ª—É—á–∞–π–Ω–æ
        function placeHamster() {
            const maxX = gameArea.offsetWidth - hamster.offsetWidth;
            const maxY = gameArea.offsetHeight - hamster.offsetHeight;
            
            hamster.style.left = Math.random() * maxX + 'px';
            hamster.style.top = Math.random() * maxY + 'px';
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ —Ö–æ–º—è–∫—É
        hamster.addEventListener('click', () => {
            if (!isGameRunning) return;
            
            score++;
            scoreDisplay.textContent = score;
            placeHamster();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            hamster.style.transform = 'scale(1.1)';
            setTimeout(() => {
                hamster.style.transform = 'scale(1)';
            }, 100);
        });
        
        // –¢–∞–π–º–µ—Ä –∏–≥—Ä—ã
        function updateTimer() {
            timeLeft--;
            timerDisplay.textContent = timeLeft;
            
            if (timeLeft <= 0) {
                endGame();
            }
        }
        
        // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
        startBtn.addEventListener('click', () => {
            if (isGameRunning) return;
            
            score = 0;
            timeLeft = 30;
            scoreDisplay.textContent = score;
            timerDisplay.textContent = timeLeft;
            
            isGameRunning = true;
            startBtn.disabled = true;
            finishBtn.disabled = false;
            
            placeHamster();
            timerInterval = setInterval(updateTimer, 1000);
        });
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        function endGame() {
            clearInterval(timerInterval);
            isGameRunning = false;
            startBtn.disabled = false;
            finishBtn.disabled = true;
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –±–æ—Ç–∞
            const coinsEarned = Math.floor(score / 3); // 1 –∫–æ–∏–Ω –∑–∞ 3 —Ç–∞–ø–∞
            
            if (window.TelegramGameProxy) {
                TelegramGameProxy.sendData({
                    user_id: userId,
                    score: score,
                    coins: coinsEarned,
                    time: 30 - timeLeft
                });
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º –∏–≥—Ä—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    TelegramGameProxy.close();
                }, 3000);
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            alert(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!\n–°—á–µ—Ç: ${score}\n–ü–æ–ª—É—á–µ–Ω–æ –∫–æ–∏–Ω–æ–≤: ${coinsEarned}`);
        }
        
        finishBtn.addEventListener('click', endGame);
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        placeHamster();
    </script>
</body>
</html>